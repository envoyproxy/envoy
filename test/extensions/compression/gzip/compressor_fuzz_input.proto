syntax = "proto3";

import "validate/validate.proto";

package envoy.extensions.compression.gzip.compressor.fuzz;

message CompressorFuzzInput {
  enum CompressionLevel {
    STANDARD_LEVEL = 0;
    BEST = 1;
    SPEED = 2;
  }

  enum CompressionStrategy {
    STANDARD_STRATEGY = 0;
    FILTERED = 1;
    HUFFMAN = 2;
    RLE = 3;
  }

  CompressionLevel compression_level = 1;
  CompressionStrategy compression_strategy = 2;
  int32 window_bits = 3 [(validate.rules).int32 = {gte: 9, lte: 15}];
  int32 memory_level = 4 [(validate.rules).int32 = {gte: 1, lte: 9}];

  // Input data chunks to be compressed.
  repeated bytes data_chunks = 5;
}
