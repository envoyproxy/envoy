syntax = "proto3";

// 1. Use "test." prefix for test-only protos.
package test.extensions.filters.http.proto_api_scrubber;

// A message mimicking a sensitive data structure.
message SensitiveMessage {
  // Field names updated to match C++ calls: .set_secret(), .set_public_field()
  string secret = 1;
  string public_field = 2;
  string other_info = 3;
}

// Renamed from BenchmarkPayload to ScrubRequest to match C++ usage.
message ScrubRequest {
  // Field names updated to match C++ usage: mutable_tags(), mutable_safe_int_map()
  map<string, string> tags = 1;
  map<string, int32> int_map = 2;
  map<string, int32> safe_int_map = 3;

  map<string, SensitiveMessage> deep_map = 4;
  map<string, SensitiveMessage> object_map = 5;
  map<string, SensitiveMessage> full_scrub_map = 6;

  // Additional fields for other tests if needed
  repeated string repeated_secrets = 7;
  repeated SensitiveMessage repeated_messages = 8;

  oneof single_choice {
    string choice_a_string = 10;
    int32 choice_b_int = 11;
  }
}

service ScrubberTestService {
  rpc Scrub(ScrubRequest) returns (ScrubRequest);
}
